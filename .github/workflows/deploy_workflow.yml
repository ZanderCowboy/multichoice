---
name: Deploy Apps
on:
  push:
    branches:
      - "develop" # return to main

  workflow_dispatch:

jobs:
  preDeploy:
    name: Setting up for Deploy
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Job Finished
        run: echo "preDeploy Job Finished"

      - name: "Echo commands"
        run: |
          echo "${{ github.head_ref }}"
          echo "${{ github.ref == 'refs/heads/main' }}"
          echo "${{ github.ref }}"

  deploy:
    name: Deploy Apps
    if: success()
    uses: ./.github/workflows/_deploy-env-apps.yml
    needs: preDeploy
    permissions:
      contents: write
    secrets: inherit
    with:
      web-environment-flag: "Web Prod"
      android-environment-flag: "Android Prod"
      android-package-name: "co.za.zanderkotze.multichoice"
      android-track: "alpha"
      android-release-name: "v1.0.0"
      android-deploy-status: "draft"
      windows-environment-flag: "Windows Prod"
